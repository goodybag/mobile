<!DOCTYPE HTML>
<!--<html manifest="cache.mf">-->
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, minimum-scale=1, user-scalable=no" />

    <link rel="stylesheet" href="/static/css/reset.css" />
    <link rel="stylesheet" href="/static/css/gb-loader.css" />
    <link rel="stylesheet" href="/static/css/main.css" />
    <link rel="stylesheet" type="text/css" href="/css/2xDpi.css" media="only screen and (-webkit-min-device-pixel-ratio: 2)" />
    <link rel="stylesheet" type="text/css" href="/css/1xDpi.css" media="only screen and (-webkit-max-device-pixel-ratio: 1)" />

    <script>
      window.applicationCache.addEventListener('updateready', function(e) {
        if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
          // Browser downloaded a new app cache.
          // Swap it in and reload the page to get the new hotness.
          // console.log("CACHE MANIFEST - CHANGES FOUND RELOADING");
          // console.log(location);
          window.applicationCache.swapCache();
          if (confirm('A new version of this site is available. Load it?')) {
            window.location.reload();
          }
        } else {
          //console.log("CACHE MANIFEST - NO CHANGES");
        }
      }, false);
    </script>
    <!--<script src="/static/3/jquery-1.7.1.min.js"></script>-->
    <!--<script src="/static/3/serializeObject.js"></script>-->
    <!--<script src="/static/3/sammy-latest.min.js"></script>-->
    <!--<script src="/static/3/sugar-1.2.3.min.js"></script>-->
    <!--<script src="/static/3/handlebars-1.0.0.beta.4.js"></script>-->
    <!--<script src="/static/3/moment-1.3.0.min.js"></script>-->
    <!--<script src="/static/3/jquery.qrcode.js"></script>-->
    <!--<script src="/static/3/qrcode.js"></script>-->
    <!--<script src="/static/3/sprintf-0.7-beta1.js"></script>-->
    <!--<script src="http://www.goodybag.com/static/js/api-client.js"></script>-->
    <!--<script src="http://www.goodybag.com/static/js/api-sync-client.js"></script>-->

    <!--<script src="/static/js/utils.js"></script>-->
    <!--<script src="/static/js/globals.js"></script>-->
    <!--<script src="/static/js/config.js"></script>-->
    <!--<script src="/static/js/functions.js"></script>-->
    <!--<script src="/static/js/transitions.js"></script>-->
    <!--<script src="/static/js/templates.js"></script>-->
    <!--<script src="/static/js/models.js"></script>-->
    <!--<script src="/static/js/views.js"></script>-->
    <!--<script src="/static/js/collections.js"></script>-->
    <!--<script src="/static/js/routes.js"></script>-->
    <!--<script src="/static/js/routers.js"></script>-->
    <!--<script src="/static/js/app.js"></script>-->

    <!--<script src="/static/js/handlebar-helpers.js"></script>-->
    <!--<script src="/static/js/streamParser.js"></script>-->

    <script src="/static/3/head.load.min.js"></script>
  </head>
  <body id="body">
    <div id="fb-root"></div>
  </body>
  <script>
  //if an apple mobile device
  // alert(navigator.userAgent);

  var headCallbacks = []; //functions to callback after the scripts have been loaded (will execute in order)
  var scripts = [
    {jQuery: "/static/3/jquery-1.7.1.min.js"}
    , {jquerySerialize: "/static/3/serializeObject.js"}
    , {sammy: "/static/3/sammy-latest.min.js"}
    , {sugar: "/static/3/sugar-1.2.3.min.js"}
    , {handlebars: "/static/3/handlebars-1.0.0.beta.4.js"}
    , {moment: "/static/3/moment-1.3.0.min.js"}
    , {jQueryQRcode: "/static/3/jquery.qrcode.js"}
    , {qrcode: "/static/3/qrcode.js"}
    , {sprintf: "/static/3/sprintf-0.7-beta1.js"}
    , {apiClient: "http://www.goodybag.com/static/js/api-client.js"}
    , {apiSyncClient: "http://www.goodybag.com/static/js/api-sync-client.js"}

    , {utils: "/static/js/utils.js"}
    , {globals: "/static/js/globals.js"}
    , {config: "/static/js/config.js"}
    , {functions: "/static/js/functions.js"}
    , {transitions: "/static/js/transitions.js"}
    , {templates: "/static/js/templates.js"}
    , {models: "/static/js/models.js"}
    , {views: "/static/js/views.js"}
    , {collections: "/static/js/collections.js"}
    , {routes: "/static/js/routes.js"}
    , {routers: "/static/js/routers.js"}
    , {app: "/static/js/app.js"}

    , {handlebarHelpers: "/static/js/handlebar-helpers.js"}
    , {streamParser: "/static/js/streamParser.js"}
  ];

  if (((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i)) || (navigator.userAgent.match(/iPad/i))) && !navigator.userAgent.match(/Safari/i)){ //in iphone app
    console.log("in-iphone-app");
    scripts.push({phonegap: "/static/3/phonegap-1.4.1.js"});
    scripts.push({phonegapFacebookPlugin: "/static/3/pg-plugin-fb-connect.js"});
    scripts.push({facebook: "/static/3/facebook_js_sdk.js"});

    headCallbacks.push(function(){
      document.addEventListener('deviceready', function() {
        // alert("device is ready");
        console.log("device is ready");
        FB.init({
          appId: "152282721508707",
          nativeInterface: PG.FB
        });
        console.log("facebookInitialized");
        // alert("facebookInitialized");
      });
    });
  } else if(navigator.userAgent.match(/goodybag-app-android/i)){ //in android app
    console.log("in-android-app");
    scripts.push({phonegap: "/static/3/cordova-android/cordova-1.5.0.js"});
    scripts.push({phonegapFacebookPlugin: "/static/3/cordova-android/cdv-plugin-fb-connect.js"});
    scripts.push({facebook: "/static/3/cordova-android/facebook_js_sdk.js"});

    headCallbacks.push(function(){
      document.addEventListener('deviceready', function() {
        // alert("device is ready");
        console.log("device is ready");
        FB.init({
          appId: "152282721508707"
          , nativeInterface: CDV.FB
          , useCachedDialogs: false
        });
        console.log("facebookInitialized");
        // alert("facebookInitialized");
      });
    });
  } else {
    console.log("in-browser");
    scripts.push({facebook: "http://connect.facebook.net/en_US/all.js#xfbml=0&appId=152282721508707"});
    headCallbacks.push(function(){
      console.log("initializing facebook");
      FB.init({appId: "152282721508707"});
    });
  }

  head.ready(function(){
    for(var i=0, length=headCallbacks.length; i<length; i++){
      headCallbacks[i].call();
    };
  });

  head.js.apply(null, scripts);
  </script>
</html>